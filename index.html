<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordini PA Test</title>
    <style>
        /* Stile per le colonne di scadenza */
        .scadenza-imminente {
            background-color: yellow;
        }
        .scadenza-arancione {
            background-color: orange;
        }
        .scadenza-rossa {
            background-color: red;
        }
        .scadenza-verde {
            background-color: green;
        }
    </style>
</head>
<body>
    <h1>Lista Ordini</h1>
    <select id="filtro-stati">
        <option value="tutti">Tutti</option>
        <option value="in-scad":>In scadenza</option> <!-- Filtro per ordini in scadenza -->
        <option value="completati">Completati</option>
    </select>
    <table>
        <thead>
            <tr>
                <th>ID Ordine</th>
                <th>Data Fattura</th>
                <th>Scadenza Imminente</th> <!-- Nuova colonna per la scadenza -->
            </tr>
        </thead>
        <tbody>
            <!-- Righe degli ordini -->
            <!-- Esempio di riga: -->
            <tr class="scadenza-imminente">
                <td>1</td>
                <td>2023-12-10</td>
                <td class="colore-scadenza"></td>
            </tr>
            <!-- Aggiungere altre righe qui -->
        </tbody>
    </table>
    <script>
        // Funzione per calcolare il colore di scadenza
        function calcolaColoreScadenza(dataFattura) {
            const oggi = new Date();
            const scadenza = new Date(dataFattura);
            const differenza = (scadenza - oggi) / (1000 * 60 * 60 * 24 * 30); // differenza in mesi
            let classeColore = '';

            if (differenza <= 1) {
                classeColore = 'scadenza-rossa'; // Rosso se imminente entro 1 mese
            } else if (differenza <= 2) {
                classeColore = 'scadenza-arancione'; // Arancione se entro 2 mesi
            } else if (differenza <= 3) {
                classeColore = 'scadenza-imminente'; // Giallo se entro 3 mesi
            } else {
                classeColore = 'scadenza-verde'; // Verde se oltre 3 mesi
            }
            return classeColore;
        }

        // Applicare il colore di scadenza alle righe della tabella
        document.querySelectorAll('tbody tr').forEach(row => {
            const dataFattura = row.cells[1].textContent;
            const colore = calcolaColoreScadenza(dataFattura);
            row.cells[2].classList.add(colore);
        });

        // Filtro per ordini in scadenza
        document.getElementById('filtro-stati').addEventListener('change', function() {
            const valoreFiltro = this.value;
            document.querySelectorAll('tbody tr').forEach(row => {
                const dataFattura = row.cells[1].textContent;
                const classeColore = row.cells[2].className;
                const scadenzaImminente = classeColore === 'scadenza-rossa' || classeColore === 'scadenza-arancione' || classeColore === 'scadenza-imminente';
                if (valoreFiltro === 'in-scad' && !scadenzaImminente) {
                    row.style.display = 'none';
                } else {
                    row.style.display = '';
                }
            });
        });
    </script>
</body>
</html>